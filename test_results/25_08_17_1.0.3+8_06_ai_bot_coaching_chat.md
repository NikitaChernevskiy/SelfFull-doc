**Date:** 2025â€‘08â€‘17  
**File:** 2025â€‘08â€‘17_1.0.3+8_06_ai_bot_coaching_chat.md
**Purpose:** Confirm that coachesâ€¯andâ€¯clients can converse with the **AIAIâ€¯Assistant** by text and (on mobile) speechâ€‘toâ€‘text, that responses render correctly, and that ancillary actions (audio playback, copy, refresh) work as intended.

---

# Test Scenario â€“ AI Coaching Chat

## 0â€¯â€¯Preâ€‘conditions
- User is signedâ€‘in  
- Stable internet connection (â‰¥â€¯2â€¯Mbps)  

---

## Aâ€¯â€¯Open Chat

1. **Tap â€œChatâ€¯Withâ€¯AIâ€** in sidebar  
   - URL path `/chatAIScreen` loads without 404  
   - Header text â€œChat with AIâœ¨â€ visible  
   - Refresh icon (âŸ³) topâ€‘right present and enabled  

2. **Initial assistant message**  
   - Bubble text â€œHello!Â How can I assist you today?â€ appears in â‰¤â€¯2â€¯s  
   - Speaker button (ğŸ”Š) inside bubble visible  
   - Subâ€‘label â€œGenerated withâ€¯AIâ€ and **CopyÂ response** link shown  

---

## Bâ€¯â€¯Send Text Message (Desktop & Mobile)

| Checkpoint | Validation Rules | Expected Result |
|------------|------------------|-----------------|
| **Message input field** | Placeholder â€œWrite a messageÂ â€¦â€ | Field gains focus on tap / click |
| Characters | Minâ€¯1, Maxâ€¯2â€¯048 | Counter turns red if limit exceeded |
| Allowed charset | UTFâ€‘8; emojis; punctuation; no script tags `<script>` | Unsafe chars escaped |
| Line breaks | Shiftâ€¯+â€¯Enter inserts newline | Message retains formatting in bubble |
| **Send button** | Solid arrow icon | Disabled when input empty; becomes active on valid text |
| Submit via Enter | Enter key without Shift sends | Same behaviour as button |
| Loading state | Spinner replaces arrow â‰¤â€¯500â€¯ms | Spinner disappears after response |

3. **Assistant response**  
   - Appears in new bubble beneath user message  
   - Average latency â‰¤â€¯5â€¯s  
   - Long responses autoâ€‘scroll chat to latest bubble  

4. **Copy response link**  
   - Copies exact text to clipboard (paste into Notes to verify)  
   - Toast *â€œCopiedâ€* displayed  

---

## Câ€¯â€¯Speechâ€‘toâ€‘Text (Mobile Only)

| Step | Detail | Expected |
|------|--------|----------|
| **Microphone icon** | Located inside message field, right side | Visible when keyboard closed |
| Tap icon | OS microphone permission prompt if first time | Choose **Allow** |
| Recording | Level meter animates while speaking | Transcribed text appears live in input |
| Stop recording | Auto stops on 3â€¯s silence **or** tap icon again | Icon reverts; transcription ready for edit |
| Validation | Same min / max / charset rules as text | Errors shown inline |
| Send | Tap arrow | Message bubble shows spoken text |

---

## Dâ€¯â€¯Textâ€‘toâ€‘Speech Playback (All Platforms)

1. **Tap speaker button (ğŸ”Š)** in any assistant bubble  
   - Audio plays via system output  
   - Second tap pauses playback  
   - Navigating away stops audio  

2. **Volume / route change**  
   - Adjust device volume â†’ playback volume changes  
   - Connect Bluetooth headset â†’ audio routes correctly  

---

## Eâ€¯â€¯Refresh Conversation

1. **Tap refresh icon (âŸ³)**  
   - Tap **refresh icon (âŸ³)** â†’ chat history empties; initial assistant greeting reappears  

---

## Fâ€¯â€¯Error Handling

| Scenario | Trigger | Expected UI |
|----------|---------|-------------|
| Backend timeout | Simulate by disabling internet, send message | Error toast *â€œUnable to reach serverâ€*; retry icon in bubble |
| Invalid token | Force logout while tab open | Redirect to Signâ€¯In screen |
| Character overflow | >â€¯2â€¯048 chars pasted | Inline error â€œCharacter limit exceededâ€ |

---

## 1â€¯â€¯Expected Outcome
- Users can exchange unlimited messages with AI within validation limits  
- Speechâ€‘toâ€‘text reliably captures input on mobile when permission granted  
- Audio playback and copy actions work on every assistant response  
- Refresh clears history without residual data  

---

## Test Checklist

| Test | Pass |
|---|---|
| User is signed-in | âœ… |
| Internet bandwidth â‰¥ 2 Mbps | âœ… |
| Sidebar shows **Chat With AI** item | âœ… |
| Tapping Chat With AI navigates to `/chatAIScreen` | âœ… |
| `/chatAIScreen` returns HTTP 200 (no 404) | âœ… |
| Header text â€œChat with AIâœ¨â€ is visible | âœ… |
| Refresh icon âŸ³ is visible | âœ… |
| Refresh icon is enabled (clickable) | âœ… |
| Initial assistant message appears â‰¤ 2 s | âŒ **Issue location:** Chat with AI screen. **Where:** Upon opening `/chatAIScreen`. **Details:** No initial message is displayed; screen remains blank until user sends a message. |
| Initial bubble text = â€œHello! How can I assist you today?â€ | âŒ **Issue location:** Chat with AI screen. **Where:** Expected first bubble. **Details:** Initial greeting bubble never appears. |
| Speaker button ğŸ”Š inside initial bubble visible | âœ… |
| Sub-label â€œGenerated with AIâ€ present | âœ… |
| **Copy response** link present | âœ… |
| **Message input** placeholder = â€œWrite a message â€¦â€ | âœ… |
| Tapping input gives it keyboard focus | âœ… |
| Typing 1 character enables Send arrow | âŒ **Issue location:** Chat with AI screen â†’ input field. **Where:** Text entry. **Details:** Blank messages can be sent; Send arrow is active even with no characters typed. |
| Typing > 2 048 chars turns counter red | âŒ **Issue location:** Chat with AI screen â†’ input field. **Where:** Character count limit. **Details:** No visible character counter; input accepts unlimited characters. |
| Pasting > 2 048 chars shows overflow error | âŒ **Issue location:** Chat with AI screen â†’ input field. **Where:** Paste handling. **Details:** No overflow error displayed; accepts all pasted text lengths. |
| Input accepts emojis | âœ… |
| Input escapes `<script>` tags | âŒ **Issue location:** Chat with AI screen â†’ input field. **Where:** Special characters handling. **Details:** `<script>` tags are rendered unescaped in message preview, potential XSS risk. |
| Shift + Enter inserts newline | âœ… |
| Newline formatting preserved in sent bubble | âœ… |
| Send arrow disabled when input empty | âŒ **Issue location:** Chat with AI screen â†’ input field. **Where:** Empty state. **Details:** Send arrow remains active even when the field is empty. |
| Send arrow enabled when input has valid text | âœ… |
| Pressing Enter (no Shift) sends message | âŒ **Issue location:** Chat with AI screen â†’ input field. **Where:** Keyboard shortcuts. **Details:** Pressing Enter inserts a new line instead of sending the message. |
| On send, arrow replaced by spinner â‰¤ 500 ms | âœ… |
| Spinner disappears after assistant reply | âœ… |
| Assistant reply bubble appears below user message | âœ… |
| Reply latency â‰¤ 5 s | âœ… |
| Long reply auto-scrolls chat to bottom | âœ… |
| Copy link on reply copies exact text | âœ… |
| Copy action shows toast â€œCopiedâ€ | âœ… |
| Tap speaker ğŸ”Š plays TTS audio | âŒ **Issue location:** Chat with AI screen. **Where:** Audio handling. **Details:** TTS is not playing on PC. |
| Second tap pauses TTS playback | âœ… |
| Navigating away stops TTS playback | âŒ **Issue location:** Chat with AI screen. **Where:** Audio handling. **Details:** TTS continues playing after navigating to other screens. |
| Changing device volume changes playback volume | âœ… |
| Connecting Bluetooth routes playback to headset | âœ… |
| Mic icon visible in input (keyboard closed) | âœ… |
| First mic tap shows permission prompt | âœ… |
| Selecting Allow enables recording | âœ… |
| Level meter animates while speaking | âŒ **Issue location:** Chat with AI screen (mobile). **Where:** Speech-to-text recording UI. **Details:** No level meter animation shown during recording. |
| Live transcription appears in input | âŒ **Issue location:** Chat with AI screen (mobile). **Where:** Speech-to-text. **Details:** Transcription appears only after recording stops, not live while speaking. |
| Recording stops on 3 s silence | âŒ **Issue location:** Chat with AI screen (mobile). **Where:** Recording stop triggers. **Details:** Recording continues indefinitely; silence detection not working. |
| Tap mic again stops recording | âœ… |
| Transcribed text obeys min/max/charset rules | âŒ **Issue location:** Chat with AI screen (mobile). **Where:** Input validation after transcription. **Details:** No enforcement of min/max length or restricted characters for STT input. |
| Send arrow submits spoken text | âœ… |
| Refresh icon tap clears all chat bubbles | âœ… |
| After refresh, initial greeting bubble reappears | âŒ **Issue location:** Chat with AI screen â†’ after refresh. **Where:** Expected initial message. **Details:** Refresh clears bubbles but no greeting bubble is reloaded. |
| Disable internet, send message â†’ toast â€œUnable to reach serverâ€ | âŒ **Issue location:** Chat with AI screen. **Where:** Network error handling. **Details:** App spins indefinitely; no error toast shown. |
| Timeout bubble shows retry icon | âŒ **Issue location:** Chat with AI screen. **Where:** Timeout handling. **Details:** No retry icon appears; message remains stuck in loading state. |
| For retry bubble, tapping retry after re-connect sends | âŒ **Issue location:** Chat with AI screen. **Where:** Retry action. **Details:** Feature not available due to missing retry icon. |
| Force logout token expiry redirects to Sign In screen | âœ… |
| Attempt to paste > 2 048 chars shows inline â€œCharacter limit exceededâ€ | âŒ **Issue location:** Chat with AI screen â†’ input field. **Where:** Paste validation. **Details:** No inline error displayed; accepts all pasted text. |
| User can send multiple messages sequentially | âœ… |
| AI can send multiple responses sequentially | âœ… |
| No message duplication occurs on rapid sends | âœ… |
| Chat history not stored after refresh | âœ… |
| Speech-to-text usable again after refresh | âœ… |
| Copy link works on every assistant bubble | âœ… |
| Speaker ğŸ”Š works on every assistant bubble | âŒ **Issue location:** Chat with AI screen. **Where:** Audio handling. **Details:** TTS is not playing on PC. |
| If one speaker starts, the other stops | âŒ **Issue location:** Chat with AI screen â†’ TTS playback. **Where:** Multiple audio streams. **Details:** Multiple assistant bubbles can play audio simultaneously instead of stopping the previous one. |