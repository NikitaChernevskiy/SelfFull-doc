**Date:** 2025â€‘08â€‘04  
**File:** 25_08_04_1.0.2+7_06_ai_bot_coaching_chat.md
**Purpose:** Confirm that coachesâ€¯andâ€¯clients can converse with the **AIAIâ€¯Assistant** by text and (on mobile) speechâ€‘toâ€‘text, that responses render correctly, and that ancillary actions (audio playback, copy, refresh) work as intended.

---

# Test Scenario â€“ AI Coaching Chat

## 0â€¯â€¯Preâ€‘conditions
- User is signedâ€‘in  
- Stable internet connection (â‰¥â€¯2â€¯Mbps)  

---

## Aâ€¯â€¯Open Chat

1. **Tap â€œChatâ€¯Withâ€¯AIâ€** in sidebar  
   - URL path `/chatAIScreen` loads without 404  
   - Header text â€œChat with AIâœ¨â€ visible  
   - Refresh icon (âŸ³) topâ€‘right present and enabled  

2. **Initial assistant message**  
   - Bubble text â€œHello!Â How can I assist you today?â€ appears in â‰¤â€¯2â€¯s  
   - Speaker button (ğŸ”Š) inside bubble visible  
   - Subâ€‘label â€œGenerated withâ€¯AIâ€ and **CopyÂ response** link shown  

---

## Bâ€¯â€¯Send Text Message (Desktop & Mobile)

| Checkpoint | Validation Rules | Expected Result |
|------------|------------------|-----------------|
| **Message input field** | Placeholder â€œWrite a messageÂ â€¦â€ | Field gains focus on tap / click |
| Characters | Minâ€¯1, Maxâ€¯2â€¯048 | Counter turns red if limit exceeded |
| Allowed charset | UTFâ€‘8; emojis; punctuation; no script tags `<script>` | Unsafe chars escaped |
| Line breaks | Shiftâ€¯+â€¯Enter inserts newline | Message retains formatting in bubble |
| **Send button** | Solid arrow icon | Disabled when input empty; becomes active on valid text |
| Submit via Enter | Enter key without Shift sends | Same behaviour as button |
| Loading state | Spinner replaces arrow â‰¤â€¯500â€¯ms | Spinner disappears after response |

3. **Assistant response**  
   - Appears in new bubble beneath user message  
   - Average latency â‰¤â€¯5â€¯s  
   - Long responses autoâ€‘scroll chat to latest bubble  

4. **Copy response link**  
   - Copies exact text to clipboard (paste into Notes to verify)  
   - Toast *â€œCopiedâ€* displayed  

---

## Câ€¯â€¯Speechâ€‘toâ€‘Text (Mobile Only)

| Step | Detail | Expected |
|------|--------|----------|
| **Microphone icon** | Located inside message field, right side | Visible when keyboard closed |
| Tap icon | OS microphone permission prompt if first time | Choose **Allow** |
| Recording | Level meter animates while speaking | Transcribed text appears live in input |
| Stop recording | Auto stops on 3â€¯s silence **or** tap icon again | Icon reverts; transcription ready for edit |
| Validation | Same min / max / charset rules as text | Errors shown inline |
| Send | Tap arrow | Message bubble shows spoken text |

---

## Dâ€¯â€¯Textâ€‘toâ€‘Speech Playback (All Platforms)

1. **Tap speaker button (ğŸ”Š)** in any assistant bubble  
   - Audio plays via system output  
   - Second tap pauses playback  
   - Navigating away stops audio  

2. **Volume / route change**  
   - Adjust device volume â†’ playback volume changes  
   - Connect Bluetooth headset â†’ audio routes correctly  

---

## Eâ€¯â€¯Refresh Conversation

1. **Tap refresh icon (âŸ³)**  
   - Tap **refresh icon (âŸ³)** â†’ chat history empties; initial assistant greeting reappears  

---

## Fâ€¯â€¯Error Handling

| Scenario | Trigger | Expected UI |
|----------|---------|-------------|
| Backend timeout | Simulate by disabling internet, send message | Error toast *â€œUnable to reach serverâ€*; retry icon in bubble |
| Invalid token | Force logout while tab open | Redirect to Signâ€¯In screen |
| Character overflow | >â€¯2â€¯048 chars pasted | Inline error â€œCharacter limit exceededâ€ |

---

## 1â€¯â€¯Expected Outcome
- Users can exchange unlimited messages with AI within validation limits  
- Speechâ€‘toâ€‘text reliably captures input on mobile when permission granted  
- Audio playback and copy actions work on every assistant response  
- Refresh clears history without residual data  

---

## Test Checklist

| Test | Pass |
|---|---|
| User is signedâ€‘in | âœ… |
| Internet bandwidth â‰¥â€¯2â€¯Mbps | âœ… |
| Sidebar shows **Chatâ€¯Withâ€¯AI** item | âœ… |
| Tapping Chatâ€¯Withâ€¯AI navigates to `/chatAIScreen` | âœ… |
| `/chatAIScreen` returns HTTPÂ 200 (no 404) | âœ… |
| Header text â€œChat with AIâœ¨â€ is visible | âœ… |
| Refresh icon âŸ³ is visible | âœ… |
| Refresh icon is enabled (clickable) | âœ… |
| Initial assistant message appears â‰¤â€¯2â€¯s | No initial message |
| Initial bubble text = â€œHello!Â How can I assist you today?â€ | No initial message |
| Speaker button ğŸ”Š inside initial bubble visible | âœ… |
| Subâ€‘label â€œGenerated withÂ AIâ€ present | âœ… |
| **Copy response** link present | âœ… |
| **Message input** placeholder = â€œWrite a messageÂ â€¦â€ | âœ… |
| Tapping input gives it keyboard focus | âœ… |
| Typing 1 character enables Send arrow | Can send blank messages |
| Typing >â€¯2â€¯048 chars turns counter red | No limit |
| Pasting >â€¯2â€¯048 chars shows overflow error | No limit |
| Input accepts emojis | âœ… |
| Input escapes `<script>` tags | No limit |
| Shiftâ€¯+â€¯Enter inserts newline | âœ… |
| Newline formatting preserved in sent bubble | âœ… |
| Send arrow disabled when input empty | Always active |
| Send arrow enabled when input has valid text | âœ… |
| Pressing Enter (no Shift) sends message | Doesn't send; adds new row|
| On send, arrow replaced by spinner â‰¤â€¯500â€¯ms | âœ… |
| Spinner disappears after assistant reply | âœ… |
| Assistant reply bubble appears below user message | âœ… |
| Reply latency â‰¤â€¯5â€¯s | âœ… |
| Long reply autoâ€‘scrolls chat to bottom | âœ… |
| Copy link on reply copies exact text | âœ… |
| Copy action shows toast â€œCopiedâ€ | âœ… |
| Tap speaker ğŸ”Š plays TTS audio | âœ… |
| Second tap pauses TTS playback | âœ… |
| Navigating away stops TTS playback | Keeps playing on other screens |
| Changing device volume changes playback volume | âœ… |
| Connecting Bluetooth routes playback to headset | âœ… |
| **Mobileâ€‘only:** Mic icon visible in input (keyboard closed) | âœ… |
| **Mobile:** First mic tap shows OS permission prompt | âœ… |
| **Mobile:** Selecting Allow enables recording | âœ… |
| **Mobile:** Level meter animates while speaking | No animation |
| **Mobile:** Live transcription appears in input | Only when user stops recording it appears whole |
| **Mobile:** Recording stops on 3â€¯s silence | User has to press stop |
| **Mobile:** Tap mic again stops recording | âœ… |
| **Mobile:** Transcribed text obeys min/max/charset rules | No limits |
| **Mobile:** Send arrow submits spoken text | âœ… |
| Refresh icon tap clears all chat bubbles | âœ… |
| After refresh, initial greeting bubble reappears | No innitial message |
| Disable internet, send message â†’ toast â€œUnable to reach serverâ€ | Spins forever |
| Timeout bubble shows retry icon | No timeout |
| For retry bubble, tapping retry after reâ€‘connect sends | No timeout |
| Force logout token expiry redirects to SignÂ In screen | âœ… |
| Attempt to paste >â€¯2â€¯048 chars shows inline â€œCharacter limit exceededâ€ | No limit |
| User can send multiple messages sequentially | âœ… |
| AI can send multiple responses sequentially | âœ… |
| No message duplication occurs on rapid sends | âœ… |
| Chat history not stored after refresh | âœ… |
| Speechâ€‘toâ€‘text usable again after refresh | âœ… |
| Copy link works on every assistant bubble | âœ… |
| Speaker ğŸ”Š works on every assistant bubble | âœ… |
| If one speaker starts, the other stops | They talk at the same time |